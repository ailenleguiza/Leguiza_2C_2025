<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>guia1_ejercicio_4_5_6: C:/Repositorios/Leguiza_2C_2025/firmware/projects/guia1_ej4/main/guia1_ej4.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">guia1_ejercicio_4_5_6
   </div>
   <div id="projectbrief">Implementación de display BCD</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_c_1_2_repositorios_2_leguiza_2_c_2025_2firmware_2projects_2guia1_ej4_2main_2guia1_ej4_8c-example.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">C:/Repositorios/Leguiza_2C_2025/firmware/projects/guia1_ej4/main/guia1_ej4.c</div></div>
</div><!--header-->
<div class="contents">
<p>Convierte un número de 32 bits a un arreglo BCD.</p>
<p>Convierte un número de 32 bits a un arreglo BCDEsta función toma un número entero de 32 bits y lo convierte a formato BCD, almacenando cada dígito decimal en posiciones separadas del arreglo. El dígito más significativo se almacena en bcd_number[0] y el menos significativo en bcd_number[digits-1].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Número de 32 bits a convertir </td></tr>
    <tr><td class="paramname">digits</td><td>Cantidad de dígitos de salida deseados </td></tr>
    <tr><td class="paramname">bcd_number</td><td>Puntero al arreglo donde se almacenarán los dígitos BCD </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int8_t Código de retorno (0 = éxito)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>bcd_number[0] será el dígito más significativo y bcd_number[digits-1] el menos significativo </dd>
<dd>
El arreglo bcd_number debe tener al menos 'digits' posiciones</dd></dl>
<p>uint32_t numero = 123; uint8_t digitos = 3; uint8_t bcd_array[3]; convertToBcdArray(numero, digitos, bcd_array); // Resultado: bcd_array[0]=1, bcd_array[1]=2, bcd_array[2]=3</p>
<div class="fragment"><div class="line"></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*==================[inclusions]=============================================*/</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;gpio_mcu.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*==================[macros and definitions]=================================*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*==================[internal data definition]===============================*/</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    gpio_t pin;         </div>
<div class="line">    io_t dir;           </div>
<div class="line">} <a id="_a0" name="_a0"></a><a class="code hl_struct" href="structgpio_conf__t.html">gpioConf_t</a>; </div>
<div class="line"> </div>
<div class="line"><span class="comment">/*==================[internal functions declaration]=========================*/</span></div>
<div class="line"></div>
<div class="line">int8_t <a id="a1" name="a1"></a><a class="code hl_function" href="guia1__ej4_8c.html#a52ee2e8838ceab35f8bdc0f4e58a0dac">convertToBcdArray</a>(uint32_t data, uint8_t digits, uint8_t * bcd_number){</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; digits; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* data % 10 obtiene el último dígito decimal de data (el dígito menos significativo) */</span></div>
<div class="line">        bcd_number[digits-i-1] = (data % 10);</div>
<div class="line">        data /= 10; </div>
<div class="line">        <span class="comment">/* para desplazar de derecha a izquierda */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a id="a2" name="a2"></a><a class="code hl_function" href="guia1__ej4_8c.html#a0661abe83ab744fce1666fb417b3fea7">configurar_pines</a>(<a class="code hl_struct" href="structgpio_conf__t.html">gpioConf_t</a> *gpio, uint8_t bcd_number){</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ((1 &lt;&lt; i) &amp; bcd_number)</div>
<div class="line">        {</div>
<div class="line">            GPIOOn(gpio[i].pin);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            GPIOOff(gpio[i].pin);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a id="a3" name="a3"></a><a class="code hl_function" href="guia1__ej4_8c.html#a7fbc285e785128c2704d101141880eaa">mostrar_numero_display</a>(uint32_t data, uint8_t digits, <a class="code hl_struct" href="structgpio_conf__t.html">gpioConf_t</a> *gpio_bcd, <a class="code hl_struct" href="structgpio_conf__t.html">gpioConf_t</a> *gpio_display){</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Crear arreglo para almacenar los dígitos BCD */</span></div>
<div class="line">    uint8_t bcd_number[digits];</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Convertir el número a BCD usando la función del punto 4 */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="guia1__ej4_8c.html#a52ee2e8838ceab35f8bdc0f4e58a0dac">convertToBcdArray</a>(data, digits, bcd_number) != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error en conversión BCD\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    printf(<span class="stringliteral">&quot;Mostrando número %&quot;</span> PRIu32 <span class="stringliteral">&quot; en display:\n&quot;</span>, data);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Recorrer cada dígito para mostrarlo en el display */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; digits; d++) {</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* Paso 1: Apagar todos los dígitos del display */</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; digits; i++) {</div>
<div class="line">            GPIOOff(gpio_display[i].pin);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* Paso 2: Configurar los pines BCD con el valor del dígito actual */</span></div>
<div class="line">        <a class="code hl_function" href="guia1__ej4_8c.html#a0661abe83ab744fce1666fb417b3fea7">configurar_pines</a>(gpio_bcd, bcd_number[d]);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* Paso 3: Activar solo el dígito actual del display */</span></div>
<div class="line">        GPIOOn(gpio_display[d].pin);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* Información de debug para seguimiento */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;  Dígito %d (posición %d): valor %u -&gt; GPIO_%u activado\n&quot;</span>, </div>
<div class="line">               d+1, d, bcd_number[d], gpio_display[d].pin);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* Para simulación, apagamos el dígito actual antes del siguiente */</span></div>
<div class="line">        GPIOOff(gpio_display[d].pin);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    printf(<span class="stringliteral">&quot;Display actualizado completamente\n\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*==================[external functions definition]==========================*/</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a id="a4" name="a4"></a><a class="code hl_function" href="guia1__ej4_8c.html#a630544a7f0a2cc40d8a7fefab7e2fe70">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    </div>
<div class="line">    uint32_t data = 138;</div>
<div class="line">    uint8_t digits = 3;</div>
<div class="line">    uint8_t bcd_number[digits];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Vector de configuración para los 4 bits BCD */</span></div>
<div class="line">    <a class="code hl_struct" href="structgpio_conf__t.html">gpioConf_t</a> gpio_bcd[4] = {</div>
<div class="line">        {GPIO_20, GPIO_OUTPUT},  <span class="comment">// b0 - bit menos significativo</span></div>
<div class="line">        {GPIO_21, GPIO_OUTPUT},  <span class="comment">// b1</span></div>
<div class="line">        {GPIO_22, GPIO_OUTPUT},  <span class="comment">// b2  </span></div>
<div class="line">        {GPIO_23, GPIO_OUTPUT}   <span class="comment">// b3 - bit más significativo</span></div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Vector de configuración para selección de dígitos del display */</span></div>
<div class="line">    <a class="code hl_struct" href="structgpio_conf__t.html">gpioConf_t</a> gpio_display[3] = {</div>
<div class="line">        {GPIO_19, GPIO_OUTPUT},  <span class="comment">// Dígito 1 (más significativo)</span></div>
<div class="line">        {GPIO_18, GPIO_OUTPUT},  <span class="comment">// Dígito 2 (medio)</span></div>
<div class="line">        {GPIO_9,  GPIO_OUTPUT}   <span class="comment">// Dígito 3 (menos significativo)</span></div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Inicializar todos los GPIOs BCD como salidas */</span> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line">        GPIOInit(gpio_bcd[i].pin, gpio_bcd[i].dir);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Inicializar todos los GPIOs del display como salidas */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line">        GPIOInit(gpio_display[i].pin, gpio_display[i].dir);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    printf(<span class="stringliteral">&quot;=== ACTIVIDAD 4: Conversión a BCD ===\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="guia1__ej4_8c.html#a52ee2e8838ceab35f8bdc0f4e58a0dac">convertToBcdArray</a>(data, digits, bcd_number) != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;convertToBcdArray: error\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Número: %&quot;</span> PRIu32 <span class="stringliteral">&quot; convertido a BCD:\n&quot;</span>, data);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;=== ACTIVIDAD 5: Configuración individual de dígitos BCD ===\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; digits; i++) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;%u &quot;</span>, bcd_number[i]);</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    printf(<span class="stringliteral">&quot;=== ACTIVIDAD 6: Display completo con multiplexado ===\n&quot;</span>);</div>
<div class="line">    <span class="comment">/* Mostrar el número completo en el display usando ambos vectores de GPIO */</span></div>
<div class="line">    <a class="code hl_function" href="guia1__ej4_8c.html#a7fbc285e785128c2704d101141880eaa">mostrar_numero_display</a>(data, digits, gpio_bcd, gpio_display);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Pruebas adicionales comentadas - descomentar para probar otros números */</span></div>
<div class="line">    <span class="comment">/*printf(&quot;Probando con número 456:\n&quot;);</span></div>
<div class="line"><span class="comment">    mostrar_numero_display(456, 3, gpio_bcd, gpio_display);</span></div>
<div class="line"><span class="comment">    </span></div>
<div class="line"><span class="comment">    printf(&quot;Probando con número 789:\n&quot;);</span></div>
<div class="line"><span class="comment">    mostrar_numero_display(789, 3, gpio_bcd, gpio_display);</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*==================[end of file]============================================*/</span></div>
<div class="ttc" id="aguia1__ej4_8c_html_a0661abe83ab744fce1666fb417b3fea7"><div class="ttname"><a href="guia1__ej4_8c.html#a0661abe83ab744fce1666fb417b3fea7">configurar_pines</a></div><div class="ttdeci">void configurar_pines(gpioConf_t *gpio, uint8_t bcd_number)</div><div class="ttdef"><b>Definition</b> guia1_ej4.c:109</div></div>
<div class="ttc" id="aguia1__ej4_8c_html_a52ee2e8838ceab35f8bdc0f4e58a0dac"><div class="ttname"><a href="guia1__ej4_8c.html#a52ee2e8838ceab35f8bdc0f4e58a0dac">convertToBcdArray</a></div><div class="ttdeci">int8_t convertToBcdArray(uint32_t data, uint8_t digits, uint8_t *bcd_number)</div><div class="ttdef"><b>Definition</b> guia1_ej4.c:72</div></div>
<div class="ttc" id="aguia1__ej4_8c_html_a630544a7f0a2cc40d8a7fefab7e2fe70"><div class="ttname"><a href="guia1__ej4_8c.html#a630544a7f0a2cc40d8a7fefab7e2fe70">app_main</a></div><div class="ttdeci">void app_main(void)</div><div class="ttdoc">Función principal de la aplicación.</div><div class="ttdef"><b>Definition</b> guia1_ej4.c:216</div></div>
<div class="ttc" id="aguia1__ej4_8c_html_a7fbc285e785128c2704d101141880eaa"><div class="ttname"><a href="guia1__ej4_8c.html#a7fbc285e785128c2704d101141880eaa">mostrar_numero_display</a></div><div class="ttdeci">void mostrar_numero_display(uint32_t data, uint8_t digits, gpioConf_t *gpio_bcd, gpioConf_t *gpio_display)</div><div class="ttdef"><b>Definition</b> guia1_ej4.c:156</div></div>
<div class="ttc" id="astructgpio_conf__t_html"><div class="ttname"><a href="structgpio_conf__t.html">gpioConf_t</a></div><div class="ttdoc">Estructura que representa la configuración de un pin GPIO.</div><div class="ttdef"><b>Definition</b> guia1_ej4.c:42</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
